From f3c26dae0dc75bc0d82196076525b1cd2e3763d9 Mon Sep 17 00:00:00 2001
From: Cory Fields <theuni-nospam-@xbmc.org>
Date: Fri, 9 Jul 2010 16:50:49 -0400
Subject: [PATCH 26/36] add build scripts

---
 .gitignore          |    5 ++++
 build_xbmc_win32.sh |   56 +++++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 61 insertions(+), 0 deletions(-)
 create mode 100644 build_xbmc_win32.sh

diff --git a/.gitignore b/.gitignore
index eac1758..70b94fc 100644
--- a/.gitignore
+++ b/.gitignore
@@ -43,3 +43,8 @@ tools/qt-faststart
 tools/trasher
 tools/trasher*.d
 version.h
+
+# ignore Windows build files
+*.def
+*.dll
+*.lib
diff --git a/build_xbmc_win32.sh b/build_xbmc_win32.sh
new file mode 100644
index 0000000..f53c987
--- /dev/null
+++ b/build_xbmc_win32.sh
@@ -0,0 +1,56 @@
+#!/bin/bash
+
+START_PATH=`pwd`
+if [ $START_PATH != "/xbmc/lib/ffmpeg" ]
+then
+cd /xbmc/lib/ffmpeg
+fi
+
+if [ -d .libs ]
+then
+rm -r .libs
+fi
+
+if [ -f config.mak ]
+then
+make distclean
+fi
+
+OPTIONS="
+--enable-shared \
+--enable-memalign-hack \
+--enable-gpl \
+--enable-w32threads \
+--enable-postproc \
+--enable-zlib \
+--disable-static \
+--disable-altivec \
+--disable-muxers \
+--disable-encoders \
+--disable-debug \
+--disable-ffplay \
+--disable-ffserver \
+--disable-ffmpeg \
+--disable-ffprobe \
+--disable-devices \
+--enable-muxer=spdif \
+--enable-muxer=adts \
+--enable-encoder=ac3 \
+--enable-encoder=aac \
+--enable-runtime-cpudetect \
+--disable-debug"
+
+./configure --extra-cflags="-fno-common -Iinclude/dxva2" --extra-ldflags="-L../../../../../system/players/dvdplayer" ${OPTIONS} &&
+ 
+make -j3 && 
+mkdir .libs &&
+cp lib*/*.dll .libs/ &&
+mv .libs/swscale-0.dll .libs/swscale-0.6.1.dll &&
+cp .libs/avcodec-52.dll /xbmc/system/players/dvdplayer/ &&
+cp .libs/avcore-0.dll /xbmc/system/players/dvdplayer/ &&
+cp .libs/avformat-52.dll /xbmc/system/players/dvdplayer/ &&
+cp .libs/avutil-50.dll /xbmc/system/players/dvdplayer/ &&
+cp .libs/postproc-51.dll /xbmc/system/players/dvdplayer/ &&
+cp .libs/swscale-0.6.1.dll /xbmc/system/players/dvdplayer/
+
+cd $START_PATH
-- 
1.7.3

